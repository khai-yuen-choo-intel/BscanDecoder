#SPF : $SPF_ROOT/bin/spf --testSeqFile bscan_EXTEST_PULSE_tx_rx_loopback_all0.spf --tapSpecFile /p/hdk/rtl/models/phdk73/ssnip_sles12/vip_spf_itpp_mtps/vip_spf_itpp_mtps-ssnip_sles12-latest/spf/bscan/collateral/mtps.bscan.tap.spfspec --itppFile bscan_EXTEST_PULSE_tx_rx_loopback_all0.itpp


## BSCAN PROJECT BASED FORCE and REGISTER SETUP
label "force_signal";
comment rem  "force_signal pch_tb.pch.dsw_pwrok 1'b1" ;
comment rem  "force_signal pch_tb.pch.pch_pwrok 1'b1" ;
comment rem  "force_signal pch_tb.pch.rsmrstb 1'b1" ;
comment rem  "force_signal pch_tb.bscan_mux_en 1'b1" ;
label "write_NTIS_STAP_to_disable_dfx_pinmode";
cycle 1;
focus_tap NTIS_STAP;
set TAPNTISWITCH_TESTMODESELCFG_CPU_Ovrd = 1'b0;
flush;
label "write_TAPCR";
cycle 1;
focus_tap cl_cltapc;
set TAPCR->RST_AND_ISOLATION_EN = 'h1;
set TAPCR->BSCANMODEOVR = 'h1;
set TAPCR->CNVI_FUNC_BSCAN_EN = 'h1;
set PRELOAD = 35'h7FFFFFFFF;
set CLTCR3->BSCAN_MODE_BYPASS_DIS = 'h1;
flush;
pass itpp "rem: poll_signal pch_tb.pch.parcnv.parcnv_pwell_wrapper.cnv1.cnv_hip_wrapper_inst_0.cnv_hip_inst.u_solar.top_lgc_inst_0.dft_inst_0.fsm_finish 1" ;
##add delay to allow dphy buffer ready
cycle 1;

#MPPHY
set BSCAN_MP_PHY_SUBSYSTEM_1->BSCANMP1RXBIGSWING = 1'h0;
set BSCAN_MP_PHY_SUBSYSTEM_1->BSCANMP1RXLVL = 'b01101;

set BSCAN_MP_PHY_SUBSYSTEM_1->BSCANMP2RXBIGSWING = 1'h0;
set BSCAN_MP_PHY_SUBSYSTEM_1->BSCANMP2RXLVL = 'b01101;

set BSCAN_MP_PHY_SUBSYSTEM_1->BSCANMP3RXBIGSWING = 1'h0;
set BSCAN_MP_PHY_SUBSYSTEM_1->BSCANMP3RXLVL = 'b01101;

set BSCAN_MP_PHY_SUBSYSTEM_1->BSCANMP4RXBIGSWING = 1'h0;
set BSCAN_MP_PHY_SUBSYSTEM_1->BSCANMP4RXLVL = 'b01101;

set BSCAN_MP_PHY_SUBSYSTEM_2->BSCANMP5RXBIGSWING = 1'h0;
set BSCAN_MP_PHY_SUBSYSTEM_2->BSCANMP5RXLVL = 'b01101;

set BSCAN_MP_PHY_SUBSYSTEM_2->BSCANMP6RXBIGSWING = 1'h0;
set BSCAN_MP_PHY_SUBSYSTEM_2->BSCANMP6RXLVL = 'b01101;

set BSCAN_MP_PHY_SUBSYSTEM_2->BSCANMP7RXBIGSWING = 1'h0;
set BSCAN_MP_PHY_SUBSYSTEM_2->BSCANMP7RXLVL = 'b01101;
flush;

#USB3
set BSCAN_USB3_PHY_SUBSYSTEM->BSCANUSB3_1RXBIGSWING = 1'h0;
set BSCAN_USB3_PHY_SUBSYSTEM->BSCANUSB3_1RXLVL = 'b01101;

set BSCAN_USB3_PHY_SUBSYSTEM->BSCANUSB3_2RXBIGSWING = 1'h0;
set BSCAN_USB3_PHY_SUBSYSTEM->BSCANUSB3_2RXLVL = 'b01101;

set BSCAN_USB3_PHY_SUBSYSTEM->BSCANUSB3_3RXBIGSWING = 1'h0;
set BSCAN_USB3_PHY_SUBSYSTEM->BSCANUSB3_3RXLVL = 'b01101;
flush;

##Release signals before preloading bscan cells
label "Release_all_signal_force";
cycle 1;
pass itpp "vector: gpp_j_7_boothalt_b(Z) prdyb(Z) preqb(Z) trigger_in(Z) ;";
pass itpp "vector: gpp_j_7_boothalt_b(X) prdyb(X) preqb(X) trigger_in(X) ;";
cycle 50;

@set tap_incremental_mode off;

pass itpp "no_compress: start;";
pass itpp "expandata: TCK, 32; ";
focus_tap cl_cltapc;
label "preload_bscan_cells";
tap_raw_shift : ir_tdi = SAMPLE_PRELOAD,
				dr_tdi = 'b11100100100100100100100100100100100100100100011010101010101010101010101010101010101010101010101010101010111001001001001001001001001001000111001001001001001001001001001001001000101100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001011111111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000110110101011111110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011100100100100100100100100100100100100100100100100100100100100010000000000000101111111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010101010101010000000000000000000000000000000000010111111111100000000000000000000000000000000000000000000000000000;
flush;
cycle 200;

#-----Extest----------
label "Extest_Begins";
tap_raw_shift : ir_tdi = EXTEST_PULSE,
				dr_tdi = 'b11100100100100100100100100100100100100100100011010101010101010101010101010101010101010101010101010101010111001001001001001001001001001000111001001001001001001001001001001001000101100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001011111111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000110110101011111110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011100100100100100100100100100100100100100100100100100100100100010000000000000101111111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010101010101010000000000000000000000000000000000010111111111100000000000000000000000000000000000000000000000000000;
flush;
cycle 1000;

label "generate_forces" ;
pass itpp "vector: usb31_1_rxp(0) usb31_1_rxn(1) usb31_2_rxp(0) usb31_2_rxn(1) usb31_3_rxp(0) usb31_3_rxn(1) usb31_4_rxp(0) usb31_4_rxn(1) usb31_5_rxp(0) usb31_5_rxn(1) usb31_6_rxp(0) usb31_6_rxn(1) usb31_7_rxp(0) usb31_7_rxn(1) usb31_8_rxp(0) usb31_8_rxn(1) usb31_9_rxp(0) usb31_9_rxn(1) usb31_10_rxp(0) usb31_10_rxn(1) pcie_24_rxp(0) pcie_24_rxn(1) pcie_23_rxp(0) pcie_23_rxn(1) pcie_22_rxp(0) pcie_22_rxn(1) pcie_21_rxp(0) pcie_21_rxn(1) dmi_4_rxp(0) dmi_4_rxn(1) dmi_5_rxp(0) dmi_5_rxn(1) dmi_6_rxp(0) dmi_6_rxn(1) dmi_7_rxp(0) dmi_7_rxn(1) dmi_0_rxp(0) dmi_0_rxn(1) dmi_1_rxp(0) dmi_1_rxn(1) dmi_2_rxp(0) dmi_2_rxn(1) dmi_3_rxp(0) dmi_3_rxn(1) pcie_1_rxp(0) pcie_1_rxn(1) pcie_2_rxp(0) pcie_2_rxn(1) pcie_3_lan_0a_rxp(0) pcie_3_lan_0a_rxn(1) pcie_4_rxp(0) pcie_4_rxn(1) pcie_5_rxp(0) pcie_5_rxn(1) pcie_6_rxp(0) pcie_6_rxn(1) pcie_7_lan_0b_rxp(0) pcie_7_lan_0b_rxn(1) pcie_8_rxp(0) pcie_8_rxn(1) pcie_9_tsn_0_rxp(0) pcie_9_tsn_0_rxn(1) pcie_10_tsn_1_rxp(0) pcie_10_tsn_1_rxn(1) pcie_11_rxp(0) pcie_11_rxn(1) pcie_12_rxp(0) pcie_12_rxn(1) pcie_17_sata_4_rxp(0) pcie_17_sata_4_rxn(1) pcie_18_sata_5_rxp(0) pcie_18_sata_5_rxn(1) pcie_19_sata_6_rxp(0) pcie_19_sata_6_rxn(1) pcie_20_sata_7_rxp(0) pcie_20_sata_7_rxn(1) pcie_13_sata_0_rxp(0) pcie_13_sata_0_rxn(1) pcie_14_sata_1_rxp(0) pcie_14_sata_1_rxn(1) pcie_15_sata_2_lan_0c_rxp(0) pcie_15_sata_2_lan_0c_rxn(1) pcie_16_sata_3_rxp(0) pcie_16_sata_3_rxn(1) ;";
cycle 1000;

pass itpp "label:Pin_USB31_01_RXP@752;";
pass itpp "label:Pin_USB31_01_RXN@751;";
pass itpp "label:Pin_USB31_02_RXP@749;";
pass itpp "label:Pin_USB31_02_RXN@748;";
pass itpp "label:Pin_USB31_03_RXP@746;";
pass itpp "label:Pin_USB31_03_RXN@745;";
pass itpp "label:Pin_USB31_04_RXP@743;";
pass itpp "label:Pin_USB31_04_RXN@742;";
pass itpp "label:Pin_USB31_05_RXP@740;";
pass itpp "label:Pin_USB31_05_RXN@739;";
pass itpp "label:Pin_USB31_06_RXP@737;";
pass itpp "label:Pin_USB31_06_RXN@736;";
pass itpp "label:Pin_USB31_07_RXP@734;";
pass itpp "label:Pin_USB31_07_RXN@733;";
pass itpp "label:Pin_USB31_08_RXP@731;";
pass itpp "label:Pin_USB31_08_RXN@730;";
pass itpp "label:Pin_USB31_09_RXP@728;";
pass itpp "label:Pin_USB31_09_RXN@727;";
pass itpp "label:Pin_USB31_10_RXP@725;";
pass itpp "label:Pin_USB31_10_RXN@724;";
pass itpp "label:Pin_PCIE_24_RXP@719;";
pass itpp "label:Pin_PCIE_24_RXN@718;";
pass itpp "label:Pin_PCIE_23_RXP@716;";
pass itpp "label:Pin_PCIE_23_RXN@715;";
pass itpp "label:Pin_PCIE_22_RXP@713;";
pass itpp "label:Pin_PCIE_22_RXN@712;";
pass itpp "label:Pin_PCIE_21_RXP@710;";
pass itpp "label:Pin_PCIE_21_RXN@709;";
pass itpp "label:Pin_DMI_04_RXP@707;";
pass itpp "label:Pin_DMI_04_RXN@706;";
pass itpp "label:Pin_DMI_05_RXP@704;";
pass itpp "label:Pin_DMI_05_RXN@703;";
pass itpp "label:Pin_DMI_06_RXP@701;";
pass itpp "label:Pin_DMI_06_RXN@700;";
pass itpp "label:Pin_DMI_07_RXP@698;";
pass itpp "label:Pin_DMI_07_RXN@697;";
pass itpp "label:Pin_DMI_00_RXP@695;";
pass itpp "label:Pin_DMI_00_RXN@694;";
pass itpp "label:Pin_DMI_01_RXP@692;";
pass itpp "label:Pin_DMI_01_RXN@691;";
pass itpp "label:Pin_DMI_02_RXP@689;";
pass itpp "label:Pin_DMI_02_RXN@688;";
pass itpp "label:Pin_DMI_03_RXP@686;";
pass itpp "label:Pin_DMI_03_RXN@685;";
pass itpp "label:Pin_PCIE_01_RXP@307;";
pass itpp "label:Pin_PCIE_01_RXN@306;";
pass itpp "label:Pin_PCIE_02_RXP@304;";
pass itpp "label:Pin_PCIE_02_RXN@303;";
pass itpp "label:Pin_PCIE_03_LAN_0A_RXP@301;";
pass itpp "label:Pin_PCIE_03_LAN_0A_RXN@300;";
pass itpp "label:Pin_PCIE_04_RXP@298;";
pass itpp "label:Pin_PCIE_04_RXN@297;";
pass itpp "label:Pin_PCIE_05_RXP@295;";
pass itpp "label:Pin_PCIE_05_RXN@294;";
pass itpp "label:Pin_PCIE_06_RXP@292;";
pass itpp "label:Pin_PCIE_06_RXN@291;";
pass itpp "label:Pin_PCIE_07_LAN_0B_RXP@289;";
pass itpp "label:Pin_PCIE_07_LAN_0B_RXN@288;";
pass itpp "label:Pin_PCIE_08_RXP@286;";
pass itpp "label:Pin_PCIE_08_RXN@285;";
pass itpp "label:Pin_PCIE_09_TSN_00_RXP@283;";
pass itpp "label:Pin_PCIE_09_TSN_00_RXN@282;";
pass itpp "label:Pin_PCIE_10_TSN_01_RXP@280;";
pass itpp "label:Pin_PCIE_10_TSN_01_RXN@279;";
pass itpp "label:Pin_PCIE_11_RXP@277;";
pass itpp "label:Pin_PCIE_11_RXN@276;";
pass itpp "label:Pin_PCIE_12_RXP@274;";
pass itpp "label:Pin_PCIE_12_RXN@273;";
pass itpp "label:Pin_PCIE_17_SATA_04_RXP@271;";
pass itpp "label:Pin_PCIE_17_SATA_04_RXN@270;";
pass itpp "label:Pin_PCIE_18_SATA_05_RXP@268;";
pass itpp "label:Pin_PCIE_18_SATA_05_RXN@267;";
pass itpp "label:Pin_PCIE_19_SATA_06_RXP@265;";
pass itpp "label:Pin_PCIE_19_SATA_06_RXN@264;";
pass itpp "label:Pin_PCIE_20_SATA_07_RXP@262;";
pass itpp "label:Pin_PCIE_20_SATA_07_RXN@261;";
pass itpp "label:Pin_PCIE_13_SATA_00_RXP@259;";
pass itpp "label:Pin_PCIE_13_SATA_00_RXN@258;";
pass itpp "label:Pin_PCIE_14_SATA_01_RXP@256;";
pass itpp "label:Pin_PCIE_14_SATA_01_RXN@255;";
pass itpp "label:Pin_PCIE_15_SATA_02_LAN_0C_RXP@253;";
pass itpp "label:Pin_PCIE_15_SATA_02_LAN_0C_RXN@252;";
pass itpp "label:Pin_PCIE_16_SATA_03_RXP@250;";
pass itpp "label:Pin_PCIE_16_SATA_03_RXN@249;";

label "Extest_Begins2";
tap_raw_shift : ir_tdi = EXTEST_PULSE,
				dr_tdi = 'b11100100100100100100100100100100100100100100011010101010101010101010101010101010101010101010101010101010111001001001001001001001001001000111001001001001001001001001001001001000101100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001011111111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000110110101011111110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011100100100100100100100100100100100100100100100100100100100100010000000000000101111111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010101010101010000000000000000000000000000000000010111111111100000000000000000000000000000000000000000000000000000,
				dr_tdo = 'bXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX01X01X01X01X01X01X01X01X01X01XXXX01X01X01X01X01X01X01X01X01X01X01X01XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX01X01X01X01X01X01X01X01X01X01X01X01X01X01X01X01X01X01X01X01XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX;
flush;
cycle 1000;

pass itpp "no_compress: stop;";
pass itpp "rem: KKL TEST END";
